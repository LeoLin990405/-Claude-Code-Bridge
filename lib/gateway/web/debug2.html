<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Gateway Debug 2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body style="background:#1a1a2e;color:white;padding:20px;font-family:monospace;">
    <div id="app">
        <h1>API Endpoint Debug</h1>
        <div v-for="test in tests" :key="test.name" style="background:#333;padding:10px;margin:10px 0;border-radius:5px;">
            <span :style="{color: test.status === 'ok' ? 'lime' : test.status === 'error' ? 'red' : 'yellow'}">
                [{{ test.status }}]
            </span>
            <strong>{{ test.name }}</strong>
            <pre v-if="test.error" style="color:red;font-size:12px;">{{ test.error }}</pre>
            <pre v-if="test.data" style="color:gray;font-size:11px;max-height:100px;overflow:auto;">{{ test.data }}</pre>
        </div>
    </div>
    <script>
        const { createApp, ref, onMounted } = Vue;

        createApp({
            setup() {
                const tests = ref([]);

                const runTest = async (name, url) => {
                    const test = { name, status: 'running', error: null, data: null };
                    tests.value.push(test);
                    try {
                        const res = await fetch(url);
                        const data = await res.json();
                        test.status = 'ok';
                        test.data = JSON.stringify(data).slice(0, 200) + '...';
                    } catch (e) {
                        test.status = 'error';
                        test.error = e.message;
                    }
                };

                onMounted(async () => {
                    await runTest('Status', '/api/status');
                    await runTest('Requests', '/api/requests?limit=10');
                    await runTest('Discussions', '/api/discussions?limit=5');
                    await runTest('API Keys', '/api/keys');
                    await runTest('Cost Summary', '/api/costs/summary');
                    await runTest('Cost by Provider', '/api/costs/by-provider?days=30');
                    await runTest('Cost by Day', '/api/costs/by-day?days=7');
                    await runTest('Memory Stats', '/api/memory/stats');
                    await runTest('Memory Sessions', '/api/memory/sessions?limit=10');
                    await runTest('Skills Stats', '/api/skills/stats');
                    await runTest('Cache Stats', '/api/cache/stats');
                    await runTest('Config', '/api/config');
                });

                return { tests };
            }
        }).mount('#app');
    </script>
</body>
</html>
